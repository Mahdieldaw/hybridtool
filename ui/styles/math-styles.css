/* 
 * Minimal KaTeX Styles
 * Only includes structural styles. Fonts are excluded to prevent bundling.
 * We use system fonts for performance and bundle size optimization.
 */

/* Import KaTeX structure (this path depends on how rehype-katex/katex are resolved, 
   but since we want to avoid bundling fonts, we'll define critical styles manually 
   or assume a very minimal set. 
   
   Actually, for strict isolation, we should NOT import the full katex.css 
   because it includes @font-face rules.
   
   Instead, we define the minimal necessary styles for layout.
*/

.katex {
    font-family: 'system-ui', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif !important;
    font-size: 1.1em;
    line-height: 1.2;
    text-rendering: optimizeLegibility;
}

/* 
   FIX: Math Overflow & Scrollbar Layout 
   - max-width: 100% prevents overflow
   - overflow-x: auto enables scrolling
   - padding-bottom: 6px reserves space for the scrollbar so it doesn't clip descenders
*/
.katex-display {
    display: block;
    margin: 1em 0;
    text-align: center;
    max-width: 100%;
    overflow-x: auto;
    overflow-y: hidden;
    padding-bottom: 6px;
}

/* Custom Slim Scrollbar for Chrome Extension */
.katex-display::-webkit-scrollbar {
    height: 6px;
}

.katex-display::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
}

.katex-display::-webkit-scrollbar-track {
    background-color: transparent;
}

.katex-html {
    display: inline-block;
}

/* Ensure fractions and other elements align correctly */
.katex .base {
    position: relative;
    white-space: nowrap;
    width: min-content;
}

/* 
   FIX: Force horizontal growth for the inner container 
   This ensures that if the math is wide, it forces the scrollbar on the parent (.katex-display)
*/
.katex-display>.katex {
    white-space: nowrap;
}

.katex .strut {
    display: inline-block;
}

/* Dark mode adjustments if needed */
@media (prefers-color-scheme: dark) {
    .katex {
        color: inherit;
        /* Inherit text color from parent */
    }

    .katex-display::-webkit-scrollbar-thumb {
        background-color: rgba(255, 255, 255, 0.2);
    }
}

/* Fix for some common KaTeX layout issues without fonts */
.katex .mord.mathnormal {
    font-style: italic;
}

.katex .msupsub {
    text-align: left;
}